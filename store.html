<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VoiceToWebsite Store | Plans & App Store</title>
    <meta
      name="description"
      content="Explore VoiceToWebsite subscription plans and exclusive App Store drops. Scale your autonomous web engineering capabilities today."
    />
    <meta
      name="keywords"
      content="web monetization, ai store, voice to website plans, app store, website subscriptions, automation tools"
    />
    <meta name="robots" content="index, follow" />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://voicetowebsite.com/store.html" />
    <meta property="og:title" content="VoiceToWebsite Store | Plans & App Store" />
    <meta
      property="og:description"
      content="Explore VoiceToWebsite subscription plans and exclusive App Store drops. Scale your autonomous web engineering capabilities today."
    />
    <meta property="og:image" content="https://voicetowebsite.com/assets/store-og.jpg" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:title" content="VoiceToWebsite Store | Plans & App Store" />
    <meta
      property="twitter:description"
      content="Explore VoiceToWebsite subscription plans and exclusive App Store drops. Scale your autonomous web engineering capabilities today."
    />
    <meta property="twitter:image" content="https://voicetowebsite.com/assets/store-og.jpg" />

    <link rel="stylesheet" href="styles.css" />
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5800977493749262"
      crossorigin="anonymous"
    ></script>
    <meta name="google-adsense-account" content="ca-pub-5800977493749262" />
  </head>
  <body>
    <div class="video-bg" aria-hidden="true"></div>
    <div class="edge-glow" aria-hidden="true"></div>
    <div class="edge-frame" aria-hidden="true"></div>

    <main class="page">
      <section class="section commerce-dashboard">
        <div class="dashboard-top">
          <div>
            <p class="eyebrow">Store Control</p>
            <h2>Commerce Dashboard</h2>
            <p class="subhead">Search across Store plans and App Store drops without leaving this page.</p>
          </div>
        </div>
        <div class="dash-kpis">
          <div class="kpi-card">
            <span class="kpi-label">Store SKUs</span>
            <span class="kpi-value">4 live</span>
            <span class="kpi-sub">Plans on this page</span>
          </div>
          <div class="kpi-card">
            <span class="kpi-label">App Store</span>
            <span class="kpi-value">4 apps</span>
            <span class="kpi-sub">Available to ship</span>
          </div>
          <div class="kpi-card">
            <span class="kpi-label">Checkout</span>
            <span class="kpi-value">PayPal + Stripe</span>
            <span class="kpi-sub">Ready to route</span>
          </div>
        </div>
        <div class="search-panels">
          <div class="search-card">
            <label class="search-label" for="storeSearch">Store search</label>
            <input
              id="storeSearch"
              type="search"
              placeholder="Search store plans (Starter, Growth, Enterprise, Lifetime)"
            />
            <p class="search-hint">Filters the Store pricing cards below in real time.</p>
          </div>
          <div class="search-card">
            <label class="search-label" for="appSearch">App Store search</label>
            <input
              id="appSearch"
              type="search"
              placeholder="Search App Store inventory (Platinum Voice, Automation Kit...)"
            />
            <div id="appSearchResults" class="search-results">
              <p class="muted">Start typing to surface App Store offers.</p>
            </div>
          </div>
        </div>
      </section>
      <section class="section">
        <h2>Storefront</h2>
        <p class="subhead">
          Match your operations pace: mix memberships with drop-in automations, then check out via PayPal or Stripe
          without leaving this grid.
        </p>
        <div class="storefront-grid">
          <article class="storefront-card flagship" data-tier="growth">
            <div class="badge pill">Most requested</div>
            <header>
              <p class="eyebrow">Growth Voice</p>
              <h3>Daily co-pilot for high-volume sites</h3>
            </header>
            <p class="storefront-copy">
              Hand off day-to-day edits, preview gating, and live deploys. Includes livestream scenes and automated
              rollbacks.
            </p>
            <div class="storefront-price">
              <div>
                <span class="currency">$</span>
                <span class="amount">249</span>
                <span class="period">/month</span>
              </div>
              <div class="meta">3 brands · unlimited variants</div>
            </div>
            <ul class="feature-grid">
              <li>
                <span>Deploy cadence</span>
                <strong>Daily + instant rollback</strong>
              </li>
              <li>
                <span>Support lane</span>
                <strong>Slack priority</strong>
              </li>
              <li>
                <span>Licensing</span>
                <strong>Monthly keys</strong>
              </li>
              <li>
                <span>Media</span>
                <strong>Livestream pack</strong>
              </li>
            </ul>
            <div class="button-row">
              <button class="primary pay-btn" data-product="growth" data-amount="24900" data-label="Growth Voice">
                PayPal
              </button>
              <button class="ghost stripe-btn" data-product="growth" data-amount="24900" data-label="Growth Voice">
                Stripe
              </button>
            </div>
          </article>

          <article class="storefront-card stack" data-tier="starter">
            <header>
              <p class="eyebrow">Starter Capsule</p>
              <div class="storefront-price compact">
                <div>
                  <span class="currency">$</span>
                  <span class="amount">79</span>
                  <span class="period">/month</span>
                </div>
                <span class="meta">Single brand</span>
              </div>
            </header>
            <p class="storefront-copy">Perfect for a single site with weekly refreshes and lightweight support.</p>
            <div class="chip-grid">
              <span>3 live pages + contact</span>
              <span>AI edit requests</span>
              <span>Weekly deploy window</span>
              <span>7-day license rotation</span>
            </div>
            <div class="button-row">
              <button class="primary pay-btn" data-product="starter" data-amount="7900" data-label="Starter Site">
                PayPal
              </button>
              <button class="ghost stripe-btn" data-product="starter" data-amount="7900" data-label="Starter Site">
                Stripe
              </button>
            </div>
          </article>

          <article class="storefront-card enterprise" data-tier="enterprise">
            <header>
              <p class="eyebrow">Enterprise Edge</p>
              <h3>Governed automation for regulated teams</h3>
            </header>
            <div class="storefront-price">
              <div>
                <span class="currency">$</span>
                <span class="amount">699</span>
                <span class="period">/month</span>
              </div>
              <div class="meta">Unlimited brands & seats</div>
            </div>
            <div class="stat-grid">
              <div>
                <span>Ops desk</span>
                <strong>24/7</strong>
              </div>
              <div>
                <span>Data work</span>
                <strong>KV · D1 · R2</strong>
              </div>
              <div>
                <span>Security</span>
                <strong>SSO + custom branding</strong>
              </div>
              <div>
                <span>Controls</span>
                <strong>Approval workflow</strong>
              </div>
            </div>
            <p class="storefront-copy">
              Includes dedicated engineer, incident bridge, and hybrid annual/monthly license catalog.
            </p>
            <div class="button-row">
              <button
                class="primary pay-btn"
                data-product="enterprise"
                data-amount="69900"
                data-label="Enterprise Edge"
              >
                PayPal
              </button>
              <button
                class="ghost stripe-btn"
                data-product="enterprise"
                data-amount="69900"
                data-label="Enterprise Edge"
              >
                Stripe
              </button>
            </div>
          </article>

          <article class="storefront-card lifetime" data-tier="lifetime">
            <div class="badge pill warm">One-time license</div>
            <header>
              <p class="eyebrow">Lifetime App Buyout</p>
              <h3>Own the full VoiceToWebsite stack</h3>
            </header>
            <div class="storefront-price">
              <div>
                <span class="currency">$</span>
                <span class="amount">4999</span>
                <span class="period">one-time</span>
              </div>
              <div class="meta">Self-host or edge-host</div>
            </div>
            <ul class="feature-grid">
              <li>
                <span>Rights</span>
                <strong>White-label + resale</strong>
              </li>
              <li>
                <span>Updates</span>
                <strong>12 months included</strong>
              </li>
              <li>
                <span>Onboarding</span>
                <strong>Priority team</strong>
              </li>
              <li>
                <span>Support</span>
                <strong>Opt-in retainer</strong>
              </li>
            </ul>
            <div class="button-row">
              <button class="primary pay-btn" data-product="lifetime" data-amount="499900" data-label="Lifetime App">
                PayPal
              </button>
              <button class="ghost stripe-btn" data-product="lifetime" data-amount="499900" data-label="Lifetime App">
                Stripe
              </button>
            </div>
          </article>
        </div>
        <p class="subhead">Products are managed in Admin → Store Manager and rendered here automatically.</p>
        <section class="store-products" aria-label="Products">
          <div class="store-product-scene" id="store-product-scene"></div>
        </section>
      </section>
    </main>
    <script src="https://js.stripe.com/v3"></script>
    <script async src="https://js.stripe.com/v3/buy-button.js"></script>
    <script>
      const PAYPAL_CLIENT =
        (window.__ENV && window.__ENV.PAYPAL_CLIENT_ID) ||
        (String("__PAYPAL_CLIENT_ID__").startsWith("__") ? "" : "__PAYPAL_CLIENT_ID__");
      const STRIPE_PK = "__STRIPE_PUBLISHABLE_KEY__";
      const STRIPE_LINKS = {
        starter: (window.__ENV && window.__ENV.STRIPE_PAYMENT_LINK_STARTER) || "",
        growth: (window.__ENV && window.__ENV.STRIPE_PAYMENT_LINK_GROWTH) || "",
        enterprise: (window.__ENV && window.__ENV.STRIPE_PAYMENT_LINK_ENTERPRISE) || "",
        lifetime: (window.__ENV && window.__ENV.STRIPE_PAYMENT_LINK_LIFETIME) || "",
      };
      const STRIPE_BUY_BUTTON_IDS = {
        starter: (window.__ENV && window.__ENV.STRIPE_BUY_BUTTON_ID_STARTER) || "",
        growth: (window.__ENV && window.__ENV.STRIPE_BUY_BUTTON_ID_GROWTH) || "",
        enterprise: (window.__ENV && window.__ENV.STRIPE_BUY_BUTTON_ID_ENTERPRISE) || "",
        lifetime: (window.__ENV && window.__ENV.STRIPE_BUY_BUTTON_ID_LIFETIME) || "",
      };
      const PAYPAL_LINKS = {
        starter: (window.__ENV && window.__ENV.PAYPAL_PAYMENT_LINK_STARTER) || "",
        growth: (window.__ENV && window.__ENV.PAYPAL_PAYMENT_LINK_GROWTH) || "",
        enterprise: (window.__ENV && window.__ENV.PAYPAL_PAYMENT_LINK_ENTERPRISE) || "",
        lifetime: (window.__ENV && window.__ENV.PAYPAL_PAYMENT_LINK_LIFETIME) || "",
      };
      const handleStripe = async (btn) => {
        const product = btn.dataset.product;
        try {
          const link = (STRIPE_LINKS[String(product || "").toLowerCase()] || "").trim();
          if (link) {
            window.location.href = link;
            return;
          }
          const stripe = Stripe(STRIPE_PK);
          const res = await fetch("/api/checkout", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ provider: "stripe", id: product }),
          });
          const data = await res.json();
          if (!data.sessionId) throw new Error(data.error || "No session");
          await stripe.redirectToCheckout({ sessionId: data.sessionId });
        } catch (err) {
          alert("Stripe checkout failed. " + err.message);
          console.warn(err);
        }
      };
      const handlePayPal = (btn) => {
        const product = btn.dataset.product;
        const label = btn.dataset.label || product;
        const amount = btn.dataset.amount;

        const link = (PAYPAL_LINKS[String(product || "").toLowerCase()] || "").trim();
        if (link) {
          window.location.href = link;
          return;
        }

        if (!PAYPAL_CLIENT || String(PAYPAL_CLIENT).startsWith("__")) {
          alert("PayPal client ID missing. Configure PAYPAL_CLIENT_ID to enable checkout.");
          return;
        }
        if (!window.paypal) {
          const script = document.createElement("script");
          script.src = `https://www.paypal.com/sdk/js?client-id=${PAYPAL_CLIENT}&currency=USD&intent=capture`;
          script.onload = () => handlePayPal(btn);
          document.head.appendChild(script);
          return;
        }

        const dollars = (Number(amount || 0) / 100).toFixed(2);
        const overlayId = "vtw-paypal-overlay";
        const containerId = "vtw-paypal-buttons";

        const existing = document.getElementById(overlayId);
        if (existing) existing.remove();

        const overlay = document.createElement("div");
        overlay.id = overlayId;
        overlay.style.position = "fixed";
        overlay.style.inset = "0";
        overlay.style.zIndex = "10000";
        overlay.style.background = "rgba(0,0,0,0.72)";
        overlay.style.backdropFilter = "blur(10px)";
        overlay.style.display = "grid";
        overlay.style.placeItems = "center";
        overlay.innerHTML = `
        <div style="width:min(520px,92vw); border:1px solid rgba(255,255,255,0.12); background:rgba(8,12,20,0.92); border-radius:16px; padding:18px;">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px;">
            <div style="font-weight:800; letter-spacing:0.14em; font-size:12px; text-transform:uppercase; color:rgba(255,255,255,0.78);">
              PayPal Checkout
            </div>
            <button id="vtw-paypal-close" style="border:1px solid rgba(255,255,255,0.16); background:rgba(255,255,255,0.06); color:white; border-radius:999px; width:34px; height:34px; cursor:pointer;">✕</button>
          </div>
          <div style="display:flex; justify-content:space-between; gap:12px; margin-bottom:10px; color:rgba(255,255,255,0.8); font-family:system-ui;">
            <div>${label}</div>
            <div style="font-weight:700;">$${dollars}</div>
          </div>
          <div id="${containerId}"></div>
          <div id="vtw-paypal-status" style="margin-top:10px; font-size:12px; color:rgba(255,255,255,0.55); font-family:system-ui;">
            You will be redirected after capture.
          </div>
        </div>
      `;

        document.body.appendChild(overlay);

        const close = () => overlay.remove();
        overlay.addEventListener("click", (e) => {
          if (e.target === overlay) close();
        });
        overlay.querySelector("#vtw-paypal-close")?.addEventListener("click", close);

        window.paypal
          .Buttons({
            style: { layout: "vertical", color: "gold", shape: "rect", label: "paypal" },
            createOrder: async () => {
              const res = await fetch("/api/checkout", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ provider: "paypal", id: product }),
              });
              const data = await res.json().catch(() => ({}));
              if (!res.ok || !data?.id) {
                throw new Error(String(data?.error || "PayPal order create failed."));
              }
              return data.id;
            },
            onApprove: async (data) => {
              try {
                const statusEl = document.getElementById("vtw-paypal-status");
                if (statusEl) statusEl.textContent = "Capturing payment...";

                const res = await fetch("/api/paypal/capture", {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify({ orderId: data?.orderID }),
                });
                const cap = await res.json().catch(() => ({}));
                if (!res.ok || !cap?.ok) throw new Error(String(cap?.error || "PayPal capture failed."));

                if (statusEl) statusEl.textContent = "Payment successful!";
                setTimeout(() => {
                  close();
                  window.location.href = `/store.html?checkout=success&product=${encodeURIComponent(product || "")}`;
                }, 1000);
              } catch (err) {
                console.warn(err);
                alert("PayPal capture failed.");
              }
            },
            onError: (err) => {
              console.warn(err);
              alert("PayPal checkout failed.");
            },
          })
          .render(`#${containerId}`);
      };
      document.querySelectorAll(".stripe-btn").forEach((btn) => {
        btn.addEventListener("click", () => handleStripe(btn));
      });

      // If Buy Button IDs are configured, replace the Stripe button with an embedded Stripe Buy Button.
      // This bypasses our /api/stripe/checkout flow and tends to be the lowest-friction path.
      document.querySelectorAll(".stripe-btn").forEach((btn) => {
        const product = String(btn.dataset.product || "").toLowerCase();
        const buyButtonId = (STRIPE_BUY_BUTTON_IDS[product] || "").trim();
        if (!buyButtonId) return;
        if (!STRIPE_PK || STRIPE_PK === "__STRIPE_PUBLISHABLE_KEY__") return;

        btn.style.display = "none";
        const parent = btn.parentElement;
        if (!parent) return;

        const wrap = document.createElement("div");
        wrap.className = "stripe-buy-button-wrap";
        const el = document.createElement("stripe-buy-button");
        el.setAttribute("buy-button-id", buyButtonId);
        el.setAttribute("publishable-key", STRIPE_PK);
        wrap.appendChild(el);
        parent.appendChild(wrap);
      });
      document.querySelectorAll(".pay-btn").forEach((btn) => {
        btn.addEventListener("click", () => handlePayPal(btn));
      });

      const openPayPalByProduct = (product) => {
        const btn = document.querySelector(`.pay-btn[data-product="${String(product || "").toLowerCase()}"]`);
        if (btn) handlePayPal(btn);
      };

      // Deep-link support for email purchase links:
      // /store.html?plan=growth&pay=paypal
      try {
        const params = new URLSearchParams(window.location.search);
        const plan = String(params.get("plan") || params.get("product") || "")
          .trim()
          .toLowerCase();
        const pay = String(params.get("pay") || "")
          .trim()
          .toLowerCase();
        if (plan && pay === "paypal") {
          // Defer so the page paints before opening the overlay.
          setTimeout(() => openPayPalByProduct(plan), 350);
        }
      } catch (_) {}
      const storeSearch = document.getElementById("storeSearch");
      const storeCards = Array.from(document.querySelectorAll(".pricing-deck .card"));

      // Store search filter logic
      const filterStore = () => {
        if (!storeSearch) return;
        const term = storeSearch.value.trim().toLowerCase();

        // Filter pricing deck
        storeCards.forEach((card) => {
          const text = card.textContent.toLowerCase();
          card.style.display = text.includes(term) ? "" : "none";
        });

        // Filter product scene
        document.querySelectorAll("#store-product-scene .vt-store-card").forEach((card) => {
          const text = card.textContent.toLowerCase();
          card.style.display = text.includes(term) ? "" : "none";
        });
      };
      storeSearch?.addEventListener("input", filterStore);

      // Initial filter if value present
      filterStore();

      const appSearch = document.getElementById("appSearch");
      const appResults = document.getElementById("appSearchResults");
      const appInventory = [
        { name: "Project Planning Hub", price: "$49", link: "project-planning-hub.html" },
        { name: "Starter Site", price: "$79/mo", link: "store.html" },
        { name: "Growth Voice", price: "$249/mo", link: "store.html" },
        { name: "Enterprise Edge", price: "$699/mo", link: "store.html" },
        { name: "Lifetime App Buyout", price: "$4,999", link: "store.html" },
        { name: "Support Retainer", price: "$299/mo", link: "appstore.html" },
        { name: "Rush Percussion", price: "$4.99", link: "rush-percussion.html" },
        { name: "Revenue Bot", price: "Free", link: "appstore.html" },
        { name: "Command Center", price: "Included", link: "appstore.html" },
      ];

      const renderAppResults = (term = "") => {
        if (!appResults) return;
        const query = term.trim().toLowerCase();
        const matches = query ? appInventory.filter((item) => item.name.toLowerCase().includes(query)) : appInventory;
        if (!matches.length) {
          appResults.innerHTML = `<p class="muted">No App Store items match yet.</p>`;
          return;
        }
        appResults.innerHTML = matches
          .map(
            (item) => `
          <div class="search-result">
            <div>
              <div class="result-title">${item.name}</div>
              <div class="result-price">${item.price}</div>
            </div>
            <a class="result-link" href="${item.link}">Open</a>
          </div>`
          )
          .join("");
      };

      appSearch?.addEventListener("input", (e) => renderAppResults(e.target.value));
      renderAppResults();
    </script>
    <script type="module" src="store-products.js"></script>
    <script type="module" src="/nav.js"></script>
  </body>
</html>
