<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VoiceToWebsite Store | Plans & App Store</title>
    <meta
      name="description"
      content="Explore VoiceToWebsite subscription plans and exclusive App Store drops. Scale your autonomous web engineering capabilities today."
    />
    <meta
      name="keywords"
      content="web monetization, ai store, voice to website plans, app store, website subscriptions, automation tools"
    />
    <meta name="robots" content="index, follow" />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://voicetowebsite.com/store.html" />
    <meta property="og:title" content="VoiceToWebsite Store | Plans & App Store" />
    <meta
      property="og:description"
      content="Explore VoiceToWebsite subscription plans and exclusive App Store drops. Scale your autonomous web engineering capabilities today."
    />
    <meta property="og:image" content="https://voicetowebsite.com/assets/store-og.jpg" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:title" content="VoiceToWebsite Store | Plans & App Store" />
    <meta
      property="twitter:description"
      content="Explore VoiceToWebsite subscription plans and exclusive App Store drops. Scale your autonomous web engineering capabilities today."
    />
    <meta property="twitter:image" content="https://voicetowebsite.com/assets/store-og.jpg" />

    <link rel="stylesheet" href="styles.css" />
    <script src="https://www.paypal.com/sdk/js?client-id=__PAYPAL_CLIENT_ID__&currency=USD"></script>
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-YOUR_PUBLISHER_ID"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <div class="video-bg" aria-hidden="true">
      <video
        src="https://cdn.coverr.co/videos/coverr-glass-building-reflections-6827/1080p.mp4"
        autoplay
        muted
        loop
        playsinline
      ></video>
    </div>
    <div class="edge-glow" aria-hidden="true"></div>
    <div class="edge-frame" aria-hidden="true"></div>
    <header class="site-header">
      <div class="nav-video">
        <video
          src="https://cdn.coverr.co/videos/coverr-glass-building-reflections-6827/1080p.mp4"
          autoplay
          muted
          loop
          playsinline
        ></video>
      </div>
      <div class="brand">
        <span class="brand-mark">VW</span>
        <div class="brand-text">
          <strong>VoiceToWebsite</strong>
          <span>Revenue Engine</span>
        </div>
      </div>
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="store.html">Store</a>
        <a href="appstore.html">App Store</a>
        <a href="blog.html">Blog</a>
        <a href="livestream.html">Live Stream</a>
        <a href="referrals.html">Referrals</a>
        <a href="projects.html">Projects</a>
        <a href="studio3000.html">3000 Studios</a>
        <a href="/admin">Admin</a>
        <a href="contact.html">Contact</a>
      </nav>
    </header>

    <main class="page">
      <section class="section commerce-dashboard">
        <div class="dashboard-top">
          <div>
            <p class="eyebrow">Store Control</p>
            <h2>Commerce Dashboard</h2>
            <p class="subhead">Search across Store plans and App Store drops without leaving this page.</p>
          </div>
        </div>
        <div class="dash-kpis">
          <div class="kpi-card">
            <span class="kpi-label">Store SKUs</span>
            <span class="kpi-value">4 live</span>
            <span class="kpi-sub">Plans on this page</span>
          </div>
          <div class="kpi-card">
            <span class="kpi-label">App Store</span>
            <span class="kpi-value">4 apps</span>
            <span class="kpi-sub">Available to ship</span>
          </div>
          <div class="kpi-card">
            <span class="kpi-label">Checkout</span>
            <span class="kpi-value">PayPal + Stripe</span>
            <span class="kpi-sub">Ready to route</span>
          </div>
        </div>
        <div class="search-panels">
          <div class="search-card">
            <label class="search-label" for="storeSearch">Store search</label>
            <input
              id="storeSearch"
              type="search"
              placeholder="Search store plans (Starter, Growth, Enterprise, Lifetime)"
            />
            <p class="search-hint">Filters the Store pricing cards below in real time.</p>
          </div>
          <div class="search-card">
            <label class="search-label" for="appSearch">App Store search</label>
            <input
              id="appSearch"
              type="search"
              placeholder="Search App Store inventory (Platinum Voice, Automation Kit...)"
            />
            <div id="appSearchResults" class="search-results">
              <p class="muted">Start typing to surface App Store offers.</p>
            </div>
          </div>
        </div>
      </section>
      <section class="section">
        <h2>Storefront</h2>
        <p class="subhead">
          Subscription-ready plans and one-time app purchase options. Licenses are issued after payment confirmation.
        </p>
        <div class="pricing-deck">
          <div class="card luxe" data-tier="starter">
            <div class="card-header">
              <div class="tier">Starter Site</div>
              <div class="price">
                <span class="currency">$</span>
                <span class="amount">79</span>
                <span class="period">/month</span>
              </div>
            </div>
            <div class="card-content">
              <ul class="features">
                <li>Single brand with AI edits</li>
                <li>3 live pages + contact</li>
                <li>Weekly deploys</li>
                <li>Weekly license key (7 days)</li>
                <li>Email support</li>
                <li class="not-included">Livestream pack</li>
                <li class="not-included">Team seats</li>
              </ul>
              <div class="button-row">
                <button class="primary pay-btn" data-product="starter" data-amount="7900" data-label="Starter Site">
                  PayPal
                </button>
                <button class="ghost stripe-btn" data-product="starter" data-amount="7900" data-label="Starter Site">
                  Stripe
                </button>
              </div>
            </div>
            <div class="shine"></div>
          </div>
          <div class="card luxe premium premium-border-glow glass-morphism" data-tier="growth">
            <div class="popular-tag">Most Popular</div>
            <div class="card-header">
              <div class="tier">Growth Voice</div>
              <div class="price">
                <span class="currency">$</span>
                <span class="amount">249</span>
                <span class="period">/month</span>
              </div>
            </div>
            <div class="card-content">
              <ul class="features">
                <li>Up to 3 brands</li>
                <li>Unlimited pages & variants</li>
                <li>Livestream pack included</li>
                <li>Daily deploys + rollback</li>
                <li>Monthly license keys</li>
                <li>Slack priority support</li>
                <li class="not-included">Dedicated engineer</li>
              </ul>
              <div class="button-row">
                <button class="primary pay-btn" data-product="growth" data-amount="24900" data-label="Growth Voice">
                  PayPal
                </button>
                <button class="ghost stripe-btn" data-product="growth" data-amount="24900" data-label="Growth Voice">
                  Stripe
                </button>
              </div>
            </div>
            <div class="shine"></div>
          </div>
          <div class="card luxe" data-tier="enterprise">
            <div class="card-header">
              <div class="tier">Enterprise Edge</div>
              <div class="price">
                <span class="currency">$</span>
                <span class="amount">699</span>
                <span class="period">/month</span>
              </div>
            </div>
            <div class="card-content">
              <ul class="features">
                <li>Unlimited brands & seats</li>
                <li>Custom data & KV/D1 setup</li>
                <li>Live ops desk 24/7</li>
                <li>Governed deploy approvals</li>
                <li>Dedicated engineer</li>
                <li>Monthly + annual license options</li>
                <li>Custom branding & SSO</li>
              </ul>
              <div class="button-row">
                <button
                  class="primary pay-btn"
                  data-product="enterprise"
                  data-amount="69900"
                  data-label="Enterprise Edge"
                >
                  PayPal
                </button>
                <button
                  class="ghost stripe-btn"
                  data-product="enterprise"
                  data-amount="69900"
                  data-label="Enterprise Edge"
                >
                  Stripe
                </button>
              </div>
            </div>
            <div class="shine"></div>
          </div>
          <div class="card luxe" data-tier="lifetime">
            <div class="popular-tag">One-Time</div>
            <div class="card-header">
              <div class="tier">Lifetime App Buyout</div>
              <div class="price">
                <span class="currency">$</span>
                <span class="amount">4999</span>
                <span class="period">one-time</span>
              </div>
            </div>
            <div class="card-content">
              <ul class="features">
                <li>Full VoiceToWebsite app</li>
                <li>Self-host or edge-host</li>
                <li>White-label rights</li>
                <li>1 year updates</li>
                <li>Perpetual license key</li>
                <li>Priority onboarding</li>
                <li>Optional support retainer</li>
              </ul>
              <div class="button-row">
                <button class="primary pay-btn" data-product="lifetime" data-amount="499900" data-label="Lifetime App">
                  PayPal
                </button>
                <button class="ghost stripe-btn" data-product="lifetime" data-amount="499900" data-label="Lifetime App">
                  Stripe
                </button>
              </div>
            </div>
            <div class="shine"></div>
          </div>
        </div>
        <p class="subhead">Products are managed in Admin → Store Manager and rendered here automatically.</p>
        <section class="store-products" aria-label="Products">
          <div class="store-product-scene" id="store-product-scene"></div>
        </section>
      </section>
    </main>
    <script src="https://js.stripe.com/v3"></script>
    <script async src="https://js.stripe.com/v3/buy-button.js"></script>
    <script>
      const PAYPAL_CLIENT =
        (window.__ENV && window.__ENV.PAYPAL_CLIENT_ID) ||
        (String("__PAYPAL_CLIENT_ID__").startsWith("__") ? "" : "__PAYPAL_CLIENT_ID__");
      const STRIPE_PK = "__STRIPE_PUBLISHABLE_KEY__";
      const STRIPE_LINKS = {
        starter: (window.__ENV && window.__ENV.STRIPE_PAYMENT_LINK_STARTER) || "",
        growth: (window.__ENV && window.__ENV.STRIPE_PAYMENT_LINK_GROWTH) || "",
        enterprise: (window.__ENV && window.__ENV.STRIPE_PAYMENT_LINK_ENTERPRISE) || "",
        lifetime: (window.__ENV && window.__ENV.STRIPE_PAYMENT_LINK_LIFETIME) || "",
      };
      const STRIPE_BUY_BUTTON_IDS = {
        starter: (window.__ENV && window.__ENV.STRIPE_BUY_BUTTON_ID_STARTER) || "",
        growth: (window.__ENV && window.__ENV.STRIPE_BUY_BUTTON_ID_GROWTH) || "",
        enterprise: (window.__ENV && window.__ENV.STRIPE_BUY_BUTTON_ID_ENTERPRISE) || "",
        lifetime: (window.__ENV && window.__ENV.STRIPE_BUY_BUTTON_ID_LIFETIME) || "",
      };
      const PAYPAL_LINKS = {
        starter: (window.__ENV && window.__ENV.PAYPAL_PAYMENT_LINK_STARTER) || "",
        growth: (window.__ENV && window.__ENV.PAYPAL_PAYMENT_LINK_GROWTH) || "",
        enterprise: (window.__ENV && window.__ENV.PAYPAL_PAYMENT_LINK_ENTERPRISE) || "",
        lifetime: (window.__ENV && window.__ENV.PAYPAL_PAYMENT_LINK_LIFETIME) || "",
      };
      const handleStripe = async (btn) => {
        const amount = btn.dataset.amount;
        const product = btn.dataset.product;
        const label = btn.dataset.label;
        try {
          const link = (STRIPE_LINKS[String(product || "").toLowerCase()] || "").trim();
          if (link) {
            window.location.href = link;
            return;
          }
          const stripe = Stripe(STRIPE_PK);
          const res = await fetch("/api/stripe/checkout", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ amount, product, label, source: "store" }),
          });
          const data = await res.json();
          if (!data.sessionId) throw new Error("No session");
          await stripe.redirectToCheckout({ sessionId: data.sessionId });
        } catch (err) {
          alert("Stripe checkout not configured. Please set STRIPE_PUBLISHABLE_KEY and backend endpoint.");
          console.warn(err);
        }
      };
      const handlePayPal = (btn) => {
        const amount = btn.dataset.amount;
        const product = btn.dataset.product;
        const label = btn.dataset.label || product;

        const link = (PAYPAL_LINKS[String(product || "").toLowerCase()] || "").trim();
        if (link) {
          window.location.href = link;
          return;
        }

        if (!PAYPAL_CLIENT || String(PAYPAL_CLIENT).startsWith("__")) {
          alert("PayPal client ID missing. Configure PAYPAL_CLIENT_ID to enable checkout.");
          return;
        }
        if (!window.paypal) {
          if (!PAYPAL_CLIENT) {
            alert("PayPal client ID missing (env var not set).");
            return;
          }
          const script = document.createElement("script");
          script.src = `https://www.paypal.com/sdk/js?client-id=${PAYPAL_CLIENT}&currency=USD`;
          script.onload = () => handlePayPal(btn);
          document.head.appendChild(script);
          return;
        }

        const dollars = (Number(amount || 0) / 100).toFixed(2);

        const overlayId = "vtw-paypal-overlay";
        const containerId = "vtw-paypal-buttons";

        const existing = document.getElementById(overlayId);
        if (existing) existing.remove();

        const overlay = document.createElement("div");
        overlay.id = overlayId;
        overlay.style.position = "fixed";
        overlay.style.inset = "0";
        overlay.style.zIndex = "9999";
        overlay.style.background = "rgba(0,0,0,0.72)";
        overlay.style.backdropFilter = "blur(10px)";
        overlay.style.display = "grid";
        overlay.style.placeItems = "center";
        overlay.innerHTML = `
        <div style="width:min(520px,92vw); border:1px solid rgba(255,255,255,0.12); background:rgba(8,12,20,0.92); border-radius:16px; padding:18px;">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px;">
            <div style="font-weight:800; letter-spacing:0.14em; font-size:12px; text-transform:uppercase; color:rgba(255,255,255,0.78);">
              PayPal Checkout
            </div>
            <button id="vtw-paypal-close" style="border:1px solid rgba(255,255,255,0.16); background:rgba(255,255,255,0.06); color:white; border-radius:999px; width:34px; height:34px; cursor:pointer;">✕</button>
          </div>
          <div style="display:flex; justify-content:space-between; gap:12px; margin-bottom:10px; color:rgba(255,255,255,0.8); font-family:system-ui;">
            <div>${label}</div>
            <div style="font-weight:700;">$${dollars}</div>
          </div>
          <div id="${containerId}"></div>
        </div>
      `;

        document.body.appendChild(overlay);

        const close = () => overlay.remove();
        overlay.addEventListener("click", (e) => {
          if (e.target === overlay) close();
        });
        overlay.querySelector("#vtw-paypal-close")?.addEventListener("click", close);

        window.paypal
          .Buttons({
            style: { layout: "vertical", color: "gold", shape: "rect", label: "paypal" },
            createOrder: async () => {
              const res = await fetch("/api/paypal/order/create", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ product }),
              });
              const data = await res.json().catch(() => ({}));
              if (!res.ok || !data?.id) {
                throw new Error(String(data?.error || "PayPal order create failed."));
              }
              return data.id;
            },
            onApprove: async (data) => {
              try {
                const res = await fetch("/api/paypal/order/capture", {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify({ orderId: data?.orderID, product }),
                });
                const cap = await res.json().catch(() => ({}));
                if (!res.ok || !cap?.ok) throw new Error(String(cap?.error || "PayPal capture failed."));
                close();
                window.location.href = `/store.html?checkout=success&product=${encodeURIComponent(product || "")}`;
              } catch (err) {
                console.warn(err);
                alert("PayPal capture failed.");
              }
            },
            onError: (err) => {
              console.warn(err);
              alert("PayPal checkout failed.");
            },
          })
          .render(`#${containerId}`);
      };
      document.querySelectorAll(".stripe-btn").forEach((btn) => {
        btn.addEventListener("click", () => handleStripe(btn));
      });

      // If Buy Button IDs are configured, replace the Stripe button with an embedded Stripe Buy Button.
      // This bypasses our /api/stripe/checkout flow and tends to be the lowest-friction path.
      document.querySelectorAll(".stripe-btn").forEach((btn) => {
        const product = String(btn.dataset.product || "").toLowerCase();
        const buyButtonId = (STRIPE_BUY_BUTTON_IDS[product] || "").trim();
        if (!buyButtonId) return;
        if (!STRIPE_PK || STRIPE_PK === "__STRIPE_PUBLISHABLE_KEY__") return;

        btn.style.display = "none";
        const parent = btn.parentElement;
        if (!parent) return;

        const wrap = document.createElement("div");
        wrap.className = "stripe-buy-button-wrap";
        const el = document.createElement("stripe-buy-button");
        el.setAttribute("buy-button-id", buyButtonId);
        el.setAttribute("publishable-key", STRIPE_PK);
        wrap.appendChild(el);
        parent.appendChild(wrap);
      });
      document.querySelectorAll(".pay-btn").forEach((btn) => {
        btn.addEventListener("click", () => handlePayPal(btn));
      });
      const storeSearch = document.getElementById("storeSearch");
      const storeCards = Array.from(document.querySelectorAll(".pricing-deck .card"));

      // Store search filter logic
      const filterStore = () => {
        if (!storeSearch) return;
        const term = storeSearch.value.trim().toLowerCase();

        // Filter pricing deck
        storeCards.forEach((card) => {
          const text = card.textContent.toLowerCase();
          card.style.display = text.includes(term) ? "" : "none";
        });

        // Filter product scene
        document.querySelectorAll("#store-product-scene .vt-store-card").forEach((card) => {
          const text = card.textContent.toLowerCase();
          card.style.display = text.includes(term) ? "" : "none";
        });
      };
      storeSearch?.addEventListener("input", filterStore);

      // Initial filter if value present
      filterStore();

      const appSearch = document.getElementById("appSearch");
      const appResults = document.getElementById("appSearchResults");
      const appInventory = [
        { name: "Project Planning Hub", price: "$49", link: "project-planning-hub.html" },
        { name: "Starter Site", price: "$79/mo", link: "store.html" },
        { name: "Growth Voice", price: "$249/mo", link: "store.html" },
        { name: "Enterprise Edge", price: "$699/mo", link: "store.html" },
        { name: "Lifetime App Buyout", price: "$4,999", link: "store.html" },
        { name: "Support Retainer", price: "$299/mo", link: "appstore.html" },
        { name: "Rush Percussion", price: "$4.99", link: "rush-percussion.html" },
        { name: "Revenue Bot", price: "Free", link: "appstore.html" },
        { name: "Command Center", price: "Included", link: "appstore.html" },
      ];

      const renderAppResults = (term = "") => {
        if (!appResults) return;
        const query = term.trim().toLowerCase();
        const matches = query ? appInventory.filter((item) => item.name.toLowerCase().includes(query)) : appInventory;
        if (!matches.length) {
          appResults.innerHTML = `<p class="muted">No App Store items match yet.</p>`;
          return;
        }
        appResults.innerHTML = matches
          .map(
            (item) => `
          <div class="search-result">
            <div>
              <div class="result-title">${item.name}</div>
              <div class="result-price">${item.price}</div>
            </div>
            <a class="result-link" href="${item.link}">Open</a>
          </div>`
          )
          .join("");
      };

      appSearch?.addEventListener("input", (e) => renderAppResults(e.target.value));
      renderAppResults();
    </script>
    <script type="module" src="store-products.js"></script>
    <script type="module" src="nav.js"></script>
    <script type="module" src="/nav.js"></script>
  </body>
</html>
